var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,i=(e,i)=>{for(var s in i||(i={}))a.call(i,s)&&o(e,s,i[s]);if(t)for(var s of t(i))l.call(i,s)&&o(e,s,i[s]);return e};import{M as s}from"./modal.cf52bcef.js";import{C as d}from"./ckeditor.1e16c881.js";import{H as n,o as c,c as r,f as m,l as p,I as h,Q as u,M as g,g as f,r as b,k as w,t as v,P,F as y,i as k,N as L}from"./vendor.0c547ad4.js";const I={props:["product","isNew","img"],emits:["get-data"],data:()=>({modal:"",bannerNum:[],channelId:[],tempProduct:{},url:"https://api.news-age.tw/",editor:d,imageLoaded:!1,image:{size:"",height:"",width:""},editorConfig:{toolbar:["heading","bold","italic","blockquote","imageUpload","link","|","numberedList","bulletedList","|","undo","redo"]}}),watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))}},mounted(){this.modal=new s(this.$refs.productModal,{keyboard:!1,backdrop:"static",focus:!1})},methods:{updateProduct(){let e="https://api.news-age.tw/ad/",t="post";this.isNew||(e=`https://api.news-age.tw/ad/${this.tempProduct.id}`,t="put",console.log("put",e),console.log("put的物件",this.product)),console.log("post",this.tempProduct),this.$http[t](e,this.tempProduct).then((e=>{console.log("回傳",e.data.data),n.success(e.data.message),this.$emit("get-data"),this.modal.hide()})).catch((e=>{console.log(e.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()},upload(e,t){if("main"==e){const e=875,a=1167,l=t.target.files[0];if(!l||0!==l.type.indexOf("image/"))return;console.log("f",l);let o=new FileReader;o.readAsDataURL(l),o.onload=t=>{let o=new Image;o.onload=()=>{if(this.image.width=o.width,this.image.height=o.height,this.imageLoaded=!0,console.log(this.image),this.image.width!==e)return n.error(`上傳圖片寬度錯誤，您上傳的寬度是${this.image.width}`),this.imageLoaded=!1,void(this.$refs.pathClear.value="");if(this.image.height!==a)return n.error(`上傳圖片高度錯誤，您上傳的高度是${this.image.height}`),this.imageLoaded=!1,void(this.$refs.pathClear.value="");if(console.log(this.imageLoaded),this.imageLoaded){const e=new FormData;e.append("imgSingle",l),this.$http.post("https://api.news-age.tw/imgUpload",e).then((e=>{this.tempProduct.imgStr=e.data,console.log("回傳",e.data),this.$refs.pathClear.value="",n.success("上傳圖片成功")})).catch((e=>{console.dir(e)}))}},o.src=t.target.result},o.onerror=e=>{console.error(e)}}else if("main2"==e){const e=1296,a=154,l=t.target.files[0];if(!l||0!==l.type.indexOf("image/"))return;console.log("f",l);let o=new FileReader;o.readAsDataURL(l),o.onload=t=>{let o=new Image;o.onload=()=>{if(this.image.width=o.width,this.image.height=o.height,this.imageLoaded=!0,console.log(this.image),this.image.width!==e)return n.error(`上傳圖片寬度錯誤，您上傳的寬度是${this.image.width}`),this.imageLoaded=!1,void(this.$refs.pathClear.value="");if(this.image.height!==a)return n.error(`上傳圖片高度錯誤，您上傳的高度是${this.image.height}`),this.imageLoaded=!1,void(this.$refs.pathClear.value="");if(console.log(this.imageLoaded),this.imageLoaded){const e=new FormData;e.append("imgSingle",l),this.$http.post("https://api.news-age.tw/imgUpload",e).then((e=>{this.tempProduct.imgLong=e.data,console.log("回傳",e.data),this.$refs.pathClear.value="",n.success("上傳圖片成功")})).catch((e=>{console.dir(e)}))}},o.src=t.target.result},o.onerror=e=>{console.error(e)}}else if("main3"==e){const e=651,a=285,l=t.target.files[0];if(!l||0!==l.type.indexOf("image/"))return;console.log("f",l);let o=new FileReader;o.readAsDataURL(l),o.onload=t=>{let o=new Image;o.onload=()=>{if(this.image.width=o.width,this.image.height=o.height,this.imageLoaded=!0,console.log(this.image),this.image.width!==e)return n.error(`上傳圖片寬度錯誤，您上傳的寬度是${this.image.width}`),this.imageLoaded=!1,void(this.$refs.pathClear.value="");if(this.image.height!==a)return n.error(`上傳圖片高度錯誤，您上傳的高度是${this.image.height}`),this.imageLoaded=!1,void(this.$refs.pathClear.value="");if(console.log(this.imageLoaded),this.imageLoaded){const e=new FormData;e.append("imgSingle",l),this.$http.post("https://api.news-age.tw/imgUpload",e).then((e=>{this.tempProduct.imgMobi=e.data,console.log("回傳",e.data),this.$refs.pathClear.value="",n.success("上傳圖片成功")})).catch((e=>{console.dir(e)}))}},o.src=t.target.result},o.onerror=e=>{console.error(e)}}}}},$={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},C={class:"modal-dialog modal-xl"},x={class:"modal-content border-0"},M={id:"productModalLabel",class:"modal-title text-center"},U={key:0},N={key:1,style:{color:"#000"}},S=m("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),O={class:"modal-body"},D={class:"row"},V={class:"col-sm-5"},j={class:"mb-3"},B=m("label",{for:"uploadImg",class:"form-label"},[f(" 新增圖片"),m("span",{class:"btn-danger ms-2 pt-1 pb-1 pe-1 ps-1"},"請上傳875x1167 (px)")],-1),F={class:"mb-3"},R=m("label",{for:"uploadImg2",class:"form-label"},[f(" 新增長型廣告圖片"),m("span",{class:"btn-danger ms-2 pt-1 pb-1 pe-1 ps-1"},"請上傳1296x154 (px)")],-1),T={class:"mb-3"},_=m("label",{for:"uploadImg3",class:"form-label"},[f(" 新增列表手機廣告圖片"),m("span",{class:"btn-danger ms-2 pt-1 pb-1 pe-1 ps-1"},"請上傳651x285 (px)")],-1),A={class:"mb-3"},G=m("p",null,"頻道放置",-1),J={class:"form-check"},q=m("label",{class:"form-check-label",for:"n1"}," 新一代觀點 ",-1),z={class:"form-check"},E=m("label",{class:"form-check-label",for:"n2"}," 話題 ",-1),H={class:"form-check"},Q=m("label",{class:"form-check-label",for:"n3"}," 台中腔 ",-1),K={class:"form-check"},W=m("label",{class:"form-check-label",for:"n4"}," 教育 ",-1),X={class:"form-check"},Y=m("label",{class:"form-check-label",for:"n5"}," 健康 ",-1),Z={class:"form-check"},ee=m("label",{class:"form-check-label",for:"n7"}," 首頁 ",-1),te={class:"col-sm-7"},ae={class:"form-floating mb-3"},le=m("label",{for:"title",class:"form-label"},"標題",-1),oe={class:"row"},ie={class:"mb-3 col-md"},se={class:"form-floating"},de=m("label",{for:"category",class:"form-label"},"連結",-1),ne={class:"modal-footer"},ce=m("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);I.render=function(e,t,a,l,o,i){return c(),r("div",$,[m("div",C,[m("div",x,[m("div",{class:[a.isNew?"bg-primary":"bg-warning","modal-header text-white"]},[m("h5",M,[a.isNew?(c(),r("span",U,"新增廣告")):(c(),r("span",N,"編輯廣告"))]),S],2),m("div",O,[m("div",D,[m("div",V,[m("div",j,[B,m("input",{accept:"image/*",type:"file",class:"form-control mb-3",id:"uploadImg",ref:"pathClear",onChange:t[1]||(t[1]=e=>i.upload("main",e))},null,544),m("div",null,[m("img",{src:o.tempProduct.imgStr,class:"img-fluid mb-3"},null,8,["src"])]),o.tempProduct.imgStr?(c(),r("button",{key:0,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[2]||(t[2]=e=>o.tempProduct.imgStr="")}," 刪除檔案 ")):p("",!0)]),m("div",F,[R,m("input",{accept:"image/*",type:"file",class:"form-control mb-3",id:"uploadImg2",ref:"pathClear",onChange:t[3]||(t[3]=e=>i.upload("main2",e))},null,544),m("div",null,[m("img",{src:o.tempProduct.imgLong,class:"img-fluid mb-3"},null,8,["src"])]),o.tempProduct.imgLong?(c(),r("button",{key:0,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[4]||(t[4]=e=>o.tempProduct.imgLong="")}," 刪除檔案 ")):p("",!0)]),m("div",T,[_,m("input",{accept:"image/*",type:"file",class:"form-control mb-3",id:"uploadImg3",ref:"pathClear",onChange:t[5]||(t[5]=e=>i.upload("main3",e))},null,544),m("div",null,[m("img",{src:o.tempProduct.imgMobi,class:"img-fluid mb-3"},null,8,["src"])]),o.tempProduct.imgMobi?(c(),r("button",{key:0,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[6]||(t[6]=e=>o.tempProduct.imgMobi="")}," 刪除檔案 ")):p("",!0)]),m("div",A,[G,m("div",J,[h(m("input",{class:"form-check-input",type:"checkbox",value:"1",id:"n1","onUpdate:modelValue":t[7]||(t[7]=e=>o.tempProduct.channelId=e)},null,512),[[u,o.tempProduct.channelId]]),q]),m("div",z,[h(m("input",{class:"form-check-input",type:"checkbox",value:"2",id:"n2","onUpdate:modelValue":t[8]||(t[8]=e=>o.tempProduct.channelId=e)},null,512),[[u,o.tempProduct.channelId]]),E]),m("div",H,[h(m("input",{class:"form-check-input",type:"checkbox",value:"3",id:"n3","onUpdate:modelValue":t[9]||(t[9]=e=>o.tempProduct.channelId=e)},null,512),[[u,o.tempProduct.channelId]]),Q]),m("div",K,[h(m("input",{class:"form-check-input",type:"checkbox",value:"4",id:"n4","onUpdate:modelValue":t[10]||(t[10]=e=>o.tempProduct.channelId=e)},null,512),[[u,o.tempProduct.channelId]]),W]),m("div",X,[h(m("input",{class:"form-check-input",type:"checkbox",value:"5",id:"n5","onUpdate:modelValue":t[11]||(t[11]=e=>o.tempProduct.channelId=e)},null,512),[[u,o.tempProduct.channelId]]),Y]),m("div",Z,[h(m("input",{class:"form-check-input",type:"checkbox",value:"7",id:"n7","onUpdate:modelValue":t[12]||(t[12]=e=>o.tempProduct.channelId=e)},null,512),[[u,o.tempProduct.channelId]]),ee])])]),m("div",te,[m("div",ae,[h(m("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":t[13]||(t[13]=e=>o.tempProduct.title=e)},null,512),[[g,o.tempProduct.title]]),le]),m("div",oe,[m("div",ie,[m("div",se,[h(m("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入連結","onUpdate:modelValue":t[14]||(t[14]=e=>o.tempProduct.link=e)},null,512),[[g,o.tempProduct.link]]),de])])])])])]),m("div",ne,[ce,m("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[15]||(t[15]=(...e)=>i.updateProduct&&i.updateProduct(...e))}," 確認 ")])])])],512)};const re={data:()=>({isLoading:!1,products:[],channelBn:"",url:"https://api.news-age.tw",tempProduct:{imagesUrl:[]},isNew:!1}),methods:{getTopList(e=""){this.isLoading=!0;let t=`${this.url}/ad/${e}`;this.$http(t).then((e=>{setTimeout((()=>{this.isLoading=!1}),1e3),this.products=e.data,console.log(this.products)})).catch((e=>{console.log(e)}))},openModal(e,t){if("add"===e)this.tempProduct={channelId:[]},this.isNew=!0,this.$refs.productModal.openModal();else if("edit"===e){this.tempProduct=i({},t),console.log("原始",this.tempProduct.channelId);let e=new Array,a=new Array;e=this.tempProduct.channelId.split(","),a=this.tempProduct.intermediaryId.split(","),this.tempProduct.channelId=e,this.tempProduct.intermediaryId=a,console.log(this.tempProduct),this.isNew=!1,this.$refs.productModal.openModal()}},delItem(e){this.tempProduct=i({},e);let t=`https://apilan.news-age.tw/ad/delete/${this.tempProduct.id}`;confirm(`刪除（${this.tempProduct.title}）?`)?(this.tempProduct.deleteStatus=1,this.$http.put(t,this.tempProduct).then((e=>{console.log("回傳",e.data),alert("刪除成功"),this.getTopList()}))):alert("你按了取消按鈕")},selectchBn(e){this.getTopList(e)}},components:{ProductModal:I},mounted(){this.getTopList()}},me={class:"crumbs"},pe=m("i",{class:"el-icon-lx-calendar",style:{"margin-right":"5px"}},null,-1),he=f(" 首頁 "),ue=f("廣告版位"),ge={class:"text-center mt-3 mb-3"},fe={key:0},be=f(" - 廣告版位 "),we={class:"container-fluid"},ve={class:"row justify-content-end"},Pe={class:"col-auto"},ye=L('<option value="">選擇頻道</option><option value="新一代觀點">新一代觀點</option><option value="話題">話題</option><option value="台中腔">台中腔</option><option value="教育">教育</option><option value="醫療">健康</option>',6),ke={class:"col-auto"},Le={class:"text-end"},Ie=f(" 建立新的文章 "),$e={class:"table"},Ce=m("thead",null,[m("tr",null,[m("th",{scope:"col"},"普通廣告"),m("th",{scope:"col"},"長型廣告"),m("th",{scope:"col"},"列表手機廣告"),m("th",{scope:"col"},"標題"),m("th",{scope:"col"})])],-1),xe={width:"300"},Me={width:"400"},Ue={width:"300"},Ne={width:"50"},Se=f("編輯"),Oe={width:"50"},De=f("刪除");re.render=function(e,t,a,l,o,i){const s=b("Loading"),d=b("el-breadcrumb-item"),n=b("el-breadcrumb"),u=b("el-button"),g=b("product-modal");return c(),r("div",null,[m(s,{active:o.isLoading},null,8,["active"]),m("div",me,[m(n,{separator:"/"},{default:w((()=>[m(d,null,{default:w((()=>[pe,he])),_:1}),m(d,null,{default:w((()=>[ue])),_:1})])),_:1})]),m("div",ge,[m("h2",null,[f(v(o.channelBn)+" ",1),""==o.channelBn?(c(),r("span",fe,"全部")):p("",!0),be])]),m("div",we,[m("div",ve,[m("div",Pe,[h(m("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":t[1]||(t[1]=e=>o.channelBn=e),onChange:t[2]||(t[2]=e=>i.selectchBn(o.channelBn))},[ye],544),[[P,o.channelBn]])]),m("div",ke,[m("div",Le,[m(u,{type:"primary",onClick:t[3]||(t[3]=e=>i.openModal("add"))},{default:w((()=>[Ie])),_:1})])])]),m("table",$e,[Ce,m("tbody",null,[(c(!0),r(y,null,k(o.products,(e=>(c(),r("tr",{key:e.id},[m("td",xe,[m("img",{src:e.imgStr,class:"img-fluid"},null,8,["src"])]),m("td",Me,[m("img",{src:e.imgLong,class:"img-fluid"},null,8,["src"])]),m("td",Ue,[m("img",{src:e.imgMobi,class:"img-fluid"},null,8,["src"])]),m("td",null,v(e.title),1),m("td",Ne,[m(u,{plain:"",type:"primary",onClick:t=>i.openModal("edit",e)},{default:w((()=>[Se])),_:2},1032,["onClick"])]),m("td",Oe,[m(u,{plain:"",type:"danger",onClick:t=>i.delItem(e)},{default:w((()=>[De])),_:2},1032,["onClick"])])])))),128))])])]),m(g,{ref:"productModal",product:o.tempProduct,"is-new":o.isNew,onGetData:i.getTopList},null,8,["product","is-new","onGetData"])])};export default re;
