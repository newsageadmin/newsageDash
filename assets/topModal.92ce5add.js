import{M as t}from"./modal.cf52bcef.js";import{C as a}from"./ckeditor.1e16c881.js";import{H as e,o,c as s,f as l,l as d,I as i,M as r,g as c,N as n}from"./vendor.0c547ad4.js";const m={props:["product","isNew","img"],emits:["get-data"],data:()=>({modal:"",tempProduct:{chId:"",chStatus:""},url:"https://api.news-age.tw/",editor:a,imageLoaded:!1,image:{size:"",height:"",width:""},editorConfig:{toolbar:["heading","bold","italic","blockquote","imageUpload","link","|","numberedList","bulletedList","|","undo","redo"]}}),watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))}},mounted(){this.modal=new t(this.$refs.productModal,{keyboard:!1,backdrop:"static",focus:!1})},methods:{updateProduct(){let t="https://api.news-age.tw/chBn",a="post";this.isNew||(t=`https://api.news-age.tw/chBn/${this.tempProduct.id}`,a="put",console.log("put",t),console.log("put的物件",this.product)),console.log("post",this.tempProduct),this.$http[a](t,this.tempProduct).then((t=>{console.log("回傳",t.data.data),e.success(t.data.message),this.$emit("get-data"),this.modal.hide()})).catch((t=>{console.log(t.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()},upload(t,a){const o=a.target.files[0];if(!o||0!==o.type.indexOf("image/"))return;console.log("f",o);let s=new FileReader;s.readAsDataURL(o),s.onload=t=>{let a=new Image;a.onload=()=>{if(this.image.width=a.width,this.image.height=a.height,this.imageLoaded=!0,console.log(this.image),1300!==this.image.width)return e.error(`上傳圖片寬度錯誤，您上傳的寬度是${this.image.width}`),this.imageLoaded=!1,void(this.$refs.pathClear.value="");if(500!==this.image.height)return e.error(`上傳圖片高度錯誤，您上傳的高度是${this.image.height}`),this.imageLoaded=!1,void(this.$refs.pathClear.value="");if(console.log(this.imageLoaded),this.imageLoaded){const t=new FormData;t.append("imgSingle",o),this.$http.post("https://api.news-age.tw/imgUpload",t).then((t=>{this.tempProduct.chFront=t.data,console.log("回傳",t.data),this.$refs.pathClear.value="",e.success("上傳圖片成功")})).catch((t=>{console.dir(t)}))}},a.src=t.target.result},s.onerror=t=>{console.error(t)}}}},p={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},h={class:"modal-dialog modal-xl"},u={class:"modal-content border-0"},g={id:"productModalLabel",class:"modal-title text-center"},b={key:0},f={key:1,style:{color:"#000"}},v=l("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),w={class:"modal-body"},y={class:"row"},P={class:"col-sm-4"},k={class:"mb-3"},L=l("label",{for:"uploadImg",class:"form-label"},[c(" 新增圖片"),l("span",{class:"btn-danger ms-2 pt-1 pb-1 pe-1 ps-1"},"請上傳1300x500 (px)")],-1),x={class:"col-sm-8"},C={class:"form-floating mb-3"},$=l("label",{for:"title",class:"form-label"},"標題",-1),M={class:"row"},N={class:"mb-3 col-md"},F={class:"form-floating"},I=l("label",{for:"category",class:"form-label"},"連結",-1),U=n('<div class="row"><div class="col-md-6"></div><div class="col-md-6"></div></div><div class="mb-3"><div class="form-floating"></div></div>',2),S={class:"modal-footer"},j=l("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);m.render=function(t,a,e,c,n,m){return o(),s("div",p,[l("div",h,[l("div",u,[l("div",{class:[e.isNew?"bg-primary":"bg-warning","modal-header text-white"]},[l("h5",g,[e.isNew?(o(),s("span",b,"新增文章")):(o(),s("span",f,"編輯文章"))]),v],2),l("div",w,[l("div",y,[l("div",P,[l("div",k,[L,l("input",{accept:"image/*",type:"file",class:"form-control mb-3",id:"uploadImg",ref:"pathClear",onChange:a[1]||(a[1]=t=>m.upload("main",t))},null,544),l("div",null,[l("img",{src:n.tempProduct.chFront,class:"img-fluid mb-3"},null,8,["src"])]),n.tempProduct.chFront?(o(),s("button",{key:0,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:a[2]||(a[2]=t=>n.tempProduct.chFront="")}," 刪除檔案 ")):d("",!0)])]),l("div",x,[l("div",C,[i(l("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":a[3]||(a[3]=t=>n.tempProduct.title=t)},null,512),[[r,n.tempProduct.title]]),$]),l("div",M,[l("div",N,[l("div",F,[i(l("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入連結","onUpdate:modelValue":a[4]||(a[4]=t=>n.tempProduct.link=t)},null,512),[[r,n.tempProduct.link]]),I])])]),U])])]),l("div",S,[j,l("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:a[5]||(a[5]=(...t)=>m.updateProduct&&m.updateProduct(...t))}," 確認 ")])])])],512)};export{m as _};
