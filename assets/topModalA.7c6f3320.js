import{M as t}from"./modal.cf52bcef.js";import{H as e,o as a,c as o,f as s,l as i,I as l,M as d,g as r}from"./vendor.0c547ad4.js";const m={props:["product","isNew"],emits:["get-data"],data:()=>({modal:"",tempProduct:{},imageLoaded:!1,apiimageUrl:"",image:{size:"",height:"",width:""}}),watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))}},mounted(){this.modal=new t(this.$refs.productModal,{keyboard:!1,backdrop:"static"})},methods:{updateProduct(){let t="https://apilan.news-age.tw/getData",a="post";this.isNew||(t=`https://apilan.news-age.tw/getData/${this.tempProduct.id}`,a="put",console.log("put",t),console.log("put的物件",this.product)),console.log("post",this.tempProduct),this.$http[a](t,this.tempProduct).then((t=>{console.log("回傳",t.data.data),e.success(t.data.message),this.$emit("get-data"),this.modal.hide()})).catch((t=>{console.log(t.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()},upload(t,a){if("main"==t){const t=1300,o=500,s=a.target.files[0];console.log("f",s);let i=new FileReader;i.readAsDataURL(s),i.onload=a=>{let i=new Image;i.onload=()=>{if(this.image.width=i.width,this.image.height=i.height,this.imageLoaded=!0,console.log(this.image),this.image.width!==t)return e.error(`上傳圖片寬度錯誤，您上傳的寬度是${this.image.width}`),void(this.imageLoaded=!1);if(this.image.height!==o)return e.error(`上傳圖片高度錯誤，您上傳的寬度是${this.image.height}`),void(this.imageLoaded=!1);if(console.log(this.imageLoaded),this.imageLoaded){const t=new FormData;t.append("imgSingle",s),this.$http.post("https://api.news-age.tw/imgUpload",t).then((t=>{this.tempProduct.imageRec=t.data,this.$refs.pathClear.value="",e.success(t.data.messgae)})).catch((t=>{console.dir(t)}))}},i.src=a.target.result},i.onerror=t=>{console.error(t)}}else if("main2"==t){const t=440,o=440,s=a.target.files[0];console.log("f",s);let i=new FileReader;i.readAsDataURL(s),i.onload=a=>{let i=new Image;i.onload=()=>{if(this.image.width=i.width,this.image.height=i.height,this.imageLoaded=!0,console.log(this.image),this.image.width!==t)return e.error(`上傳圖片寬度錯誤，您上傳的寬度是${this.image.width}`),void(this.imageLoaded=!1);if(this.image.height!==o)return e.error(`上傳圖片高度錯誤，您上傳的寬度是${this.image.height}`),void(this.imageLoaded=!1);if(this.imageLoaded){const t=new FormData;t.append("imgSingle",s),this.$http.post("https://api.news-age.tw/imgUpload",t).then((t=>{console.log(t.data),this.tempProduct.imageSqu=t.data,this.$refs.pathClear.value="",e.success("圖片上傳成功")})).catch((t=>{console.dir(t)}))}},i.src=a.target.result},i.onerror=t=>{console.error(t)}}},formDate:t=>t.split("T")[0]}},c={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},n={class:"modal-dialog modal-xl"},p={class:"modal-content border-0"},h={id:"productModalLabel",class:"modal-title text-center"},g={key:0},u={key:1,style:{color:"#000"}},b=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),f={class:"modal-body"},w={class:"row"},y={class:"col-sm-4"},P={class:"mb-3"},v=s("label",{for:"uploadImg",class:"form-label"},[r("新增圖片"),s("span",{class:"btn-danger ms-2 pt-1 pb-1 pe-1 ps-1"},"請上傳440x440 (px)")],-1),x={class:"mb-3"},L={key:0,for:"uploadImg",class:"form-label"},k=r("新增圖片"),$=s("span",{class:"btn-danger ms-2 pt-1 pb-1 pe-1 ps-1"},"請上傳1300x500 (px)",-1),C={class:"col-sm-8"},S={class:"form-floating mb-3"},M=s("label",{for:"title",class:"form-label"},"標題",-1),R=s("hr",null,null,-1),D={class:"mb-3"},I={class:"form-floating"},U=s("label",{for:"description",class:"form-label"},"簡短描述文",-1),q={class:"modal-footer"},N=s("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);m.render=function(t,e,r,m,F,j){return a(),o("div",c,[s("div",n,[s("div",p,[s("div",{class:[r.isNew?"bg-primary":"bg-warning","modal-header text-white"]},[s("h5",h,[r.isNew?(a(),o("span",g,"新增文章")):(a(),o("span",u,"編輯文章"))]),b],2),s("div",f,[s("div",w,[s("div",y,[s("div",P,[v,s("input",{type:"file",class:"form-control mb-3",id:"uploadImg",ref:"pathClear",onChange:e[1]||(e[1]=t=>j.upload("main2",t))},null,544),s("img",{class:"img-fluid mb-3",src:F.tempProduct.imageSqu},null,8,["src"]),F.tempProduct.imageSqu?(a(),o("button",{key:0,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[2]||(e[2]=t=>F.tempProduct.imageSqu="")}," 刪除檔案 ")):i("",!0)]),s("div",x,[F.tempProduct.imageSqu?(a(),o("label",L,[k,$])):i("",!0),F.tempProduct.imageSqu?(a(),o("input",{key:1,type:"file",class:"form-control mb-3",id:"uploadImg",ref:"pathClear",onChange:e[3]||(e[3]=t=>j.upload("main",t))},null,544)):i("",!0),s("img",{class:"img-fluid mb-3",src:F.tempProduct.imageRec},null,8,["src"]),F.tempProduct.imageRec?(a(),o("button",{key:2,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[4]||(e[4]=t=>F.tempProduct.imageRec="")}," 刪除檔案 ")):i("",!0)])]),s("div",C,[s("div",S,[l(s("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[5]||(e[5]=t=>F.tempProduct.title=t)},null,512),[[d,F.tempProduct.title]]),M]),R,s("div",D,[s("div",I,[l(s("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入簡短敘述文","onUpdate:modelValue":e[6]||(e[6]=t=>F.tempProduct.subtext=t),style:{height:"150px"}},null,512),[[d,F.tempProduct.subtext]]),U])])])])]),s("div",q,[N,s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:e[7]||(e[7]=(...t)=>j.updateProduct&&j.updateProduct(...t))}," 確認 ")])])])],512)};export{m as _};
